function lda2
orig=[-0.26,0.96,0.01,-0.02,-0.02,0.05,-0.03,-0.00,0.00,0.02,-0.01,-0.01,0.00,0.00,-0.00,0.01,0.01,0.00,0.01,-0.00,0.00,0.00,0.00,0.00,0.00,-0.00,-0.00,0.01,0.00,-0.02,-0.01,0.00,-0.01,-0.00,-0.00,-0.01,-0.01,-0.01,-0.01,0.02,0.06,0.04,-0.04,0.16;
-0.47,0.88,-0.01,-0.03,-0.02,0.03,-0.04,0.01,0.00,0.02,-0.01,0.01,0.01,0.01,-0.01,0.01,0.00,0.00,-0.00,0.01,-0.00,0.00,-0.01,-0.00,-0.00,-0.01,0.00,0.00,0.01,-0.00,0.00,-0.00,-0.00,0.01,-0.01,0.00,-0.02,-0.00,-0.02,-0.00,0.02,0.07,-0.12,0.13;
0.12,0.99,0.13,0.47,0.04,0.23,0.05,-0.00,0.08,0.20,-0.10,-0.10,-0.06,0.00,0.04,0.02,0.04,0.01,0.02,-0.01,0.02,0.00,-0.01,-0.02,-0.03,-0.00,0.02,-0.02,0.03,0.01,0.06,0.00,-0.02,-0.05,-0.19,0.20,-0.05,-0.08,0.07,0.02,0.00,0.02,0.04,0.05;
-0.09,1.00,-0.07,0.34,-0.01,0.16,-0.02,0.08,-0.07,0.06,0.05,-0.15,-0.04,0.05,0.01,0.04,0.02,0.02,-0.00,0.00,-0.00,-0.02,-0.01,-0.02,0.01,0.01,-0.02,0.01,-0.00,-0.01,0.02,-0.05,-0.05,-0.10,0.04,0.18,-0.06,0.06,-0.02,0.00,0.04,-0.00,0.03,0.06;
-0.04,1.00,-0.05,0.47,-0.04,0.21,0.01,0.03,-0.01,0.18,-0.07,-0.15,-0.03,0.02,0.03,0.05,0.03,0.02,0.01,-0.00,-0.01,0.01,0.01,-0.02,-0.03,0.02,-0.01,-0.02,0.02,-0.00,0.06,-0.03,0.00,-0.12,-0.06,0.23,-0.09,0.00,0.01,0.01,0.05,0.02,0.06,0.14;
-0.25,0.97,-0.17,0.26,-0.02,0.13,-0.06,0.05,-0.05,0.03,0.06,-0.12,-0.05,0.03,-0.00,0.01,0.01,0.04,-0.02,0.01,0.01,-0.01,-0.02,-0.01,0.00,0.03,-0.01,0.01,-0.01,-0.03,0.02,-0.01,-0.03,-0.08,0.00,0.17,-0.02,0.07,0.02,-0.04,0.09,-0.04,0.00,0.14;
-0.05,1.00,-0.07,0.32,-0.02,0.13,-0.02,0.06,-0.05,0.07,0.03,-0.15,-0.04,0.06,0.00,0.04,0.02,0.01,-0.00,0.01,-0.01,-0.01,-0.02,-0.02,0.01,0.02,-0.01,0.01,0.01,-0.02,0.02,-0.04,-0.04,-0.08,0.05,0.22,-0.03,0.07,0.01,-0.01,0.06,-0.07,0.05,0.01;
-0.18,0.98,-0.13,0.32,-0.03,0.14,-0.03,0.07,-0.06,0.02,0.07,-0.12,-0.06,0.05,0.01,0.03,0.01,0.02,-0.01,-0.00,-0.00,-0.02,-0.01,-0.02,0.00,0.01,-0.02,0.02,-0.01,-0.01,0.04,-0.01,-0.03,-0.11,0.02,0.16,-0.08,0.09,-0.03,-0.01,0.05,-0.05,0.07,0.05;
-0.13,0.99,-0.08,0.33,-0.01,0.12,-0.01,0.05,-0.04,0.06,0.01,-0.15,-0.01,0.06,0.02,0.03,0.02,-0.00,-0.00,-0.00,-0.02,-0.01,0.00,-0.02,-0.01,0.02,-0.02,-0.01,-0.01,-0.00,0.04,-0.02,0.03,-0.11,-0.03,0.16,-0.08,0.01,-0.01,0.01,0.02,0.03,0.05,0.11;
-0.18,0.98,-0.09,0.37,-0.08,0.09,0.02,0.09,-0.09,-0.00,0.11,-0.07,-0.06,-0.00,-0.02,0.06,0.02,0.02,-0.01,0.00,0.01,-0.02,-0.02,0.01,0.01,-0.00,-0.00,0.01,-0.00,-0.02,0.02,-0.07,-0.07,-0.01,0.09,0.11,-0.07,0.12,-0.01,-0.07,0.04,-0.04,0.13,0.06;
-0.24,0.97,-0.20,0.29,-0.04,0.14,-0.06,0.04,-0.06,0.01,0.10,-0.09,-0.08,0.03,-0.01,0.03,0.01,0.03,0.01,-0.02,0.01,-0.01,-0.03,0.00,0.01,0.00,-0.01,0.03,-0.01,-0.00,0.02,-0.04,-0.07,-0.08,0.08,0.14,-0.04,0.09,-0.04,0.01,0.07,-0.01,0.02,0.06;
-0.17,0.99,-0.14,0.35,-0.08,0.10,-0.02,0.07,-0.08,-0.05,0.11,-0.01,-0.06,-0.01,-0.03,0.05,0.01,0.01,0.00,-0.02,0.02,-0.01,-0.01,0.00,-0.01,-0.02,0.01,0.04,0.01,0.02,-0.01,-0.08,-0.07,0.00,0.11,-0.01,-0.03,0.15,-0.04,0.01,0.03,0.01,0.14,0.09];

D=size(orig,2);
X=[];
if 0
X=double([4 1; 2 4; 2 3; 3 6; 4 4; 9 10; 6 8; 9 5; 8 7; 10 8]);
%Y=[zeros(3,1); ones(3,1); ones(4,1)*2];
Y=[zeros(5,1); ones(5,1)];
else
D=2;
X=double([randn(3,D)-2;randn(3,D);randn(4,D)+2]);
Y=[zeros(3,1); ones(3,1); ones(4,1)*2];

X=double([randn(2,D)-2;randn(10,D)]);
Y=[zeros(2,1); ones(10,1)];
end

X=(orig(:,1:4))
%X=orig;
Y=[zeros(2,1); ones(10,1)];

N=size(X,1);
D=size(X,2);
K=size(C,1);
C=unique(Y);

for i=1:K
  dat(i).w=find(Y==C(i));
  dat(i).mu=mean(X(dat(i).w,:));
  % dat(i).S=...%(1/(size(X,1)-length(dat(i).w)))*...
  % dat(i).S=(1/length(dat(i).w))*...
  dat(i).S= ...
           (X(dat(i).w,:)-repmat(dat(i).mu,[length(dat(i).w) 1]))'* ...
           (X(dat(i).w,:)-repmat(dat(i).mu,[length(dat(i).w) 1]));
  dat(i).N=length(dat(i).w);
end

%% within-class scatter 
Sw=zeros(size(dat(1).S));
for i=1:K,Sw = Sw+dat(i).S; end
%inv(Sw);
%% between-class scatter
%Sb = (dat(1).mu-dat(2).mu)'*(dat(1).mu-dat(2).mu);Sb(1:4,1:4)
Sb=zeros([D D]);
mu=mean(X,1);
for i=1:K,Sb=Sb+dat(i).N*(dat(i).mu-mu)'*(dat(i).mu-mu);end
%Sb(1:4,1:4)

%W=zeros(K,D+1);for i=1:K,tmp=dat(i).mu*inv(Sw);W(i,1) = ...
%-0.5*tmp*dat(i).mu'+log(length(dat(i).w)/size(X,1));W(i,2:D+1) = ...
%tmp;end
[U S V]=svd(inv(Sw)*Sb);
W=U(:,1);

sprintf('%f,', W),
muW=[];for i=1:K,muW=[muW dat(i).mu*W];end,sprintf('%f,',muW)

L=X*W;
P=zeros(size(X,1),K);
for i=1:K
  P(:,i)=abs(L-repmat(muW(i),[N 1]));%'*(L-repmat(muW(i),[N 1]));
end
P=1./(P+1e-5);
res=P./repmat(sum(P,2),[1 K])

%L1=(L-repmat(dat(1).mu*W,[size(X,1) 1])).^2;
%L2=(L-repmat(dat(2).mu*W,[size(X,1) 1])).^2;
%[(1-L1./(L1+L2)) (1-L2./(L1+L2))]

%L=[ones(size(X,1),1) X]*W';
%L(:,1)>L(:,2)
%P = exp(L) ./ repmat(sum(exp(L),2),[1 K])
%P = 2.^L ./ repmat(sum(2.^L,2),[1 K])

if 0,
clf;
hold on;
h=plot(X(1:2,1),X(1:2,2),'ro');
set(h,'MarkerFaceColor','r');
%h=plot(X(4:6,1),X(4:6,2),'go');
%set(h,'MarkerFaceColor','g');
h=plot(X(3:10,1),X(3:10,2),'bs');
set(h,'MarkerFaceColor','b');
hold off;
end

